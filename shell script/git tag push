Test-Path $PROFILE
New-Item -Path $PROFILE -Type File -Force
notepad $PROFILE
. $PROFILE
Set-ExecutionPolicy RemoteSigned -Scope CurrentUser

function gtp($tagName) {

    $datePrefix = "release_" + (Get-Date -Format "yyyyMMdd")
    $dateSubfix = (Get-Date -Format "HHmm")
    if ([string]::IsNullOrWhiteSpace($tagName)) {
        $fullTagName = $datePrefix + "_" + $dateSubfix
    } else {
        $fullTagName = $datePrefix + "_" + $tagName + "_" + $dateSubfix
    }

    if (git tag -l $fullTagName) {
        try {
            git push origin refs/tags/$fullTagName
        }
        catch {
            Write-Error "Error occurred: $_"
        }
    }
    else {
        try {
            git tag $fullTagName
            if ($?) { 
                try {
                    git push origin $fullTagName
                }
                catch {
                    Write-Error "Error occurred while pushing: $_"
                    git tag -d $fullTagName
                }
            }
        }
        catch {
            Write-Error "Error occurred while creating tag: $_"
        }
    }
}
